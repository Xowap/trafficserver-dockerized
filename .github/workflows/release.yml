name: Release

on:
    workflow_dispatch:

jobs:
    call-build-image:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                include:
                    - base: default
                      tag: latest
                    - base: no-hwloc
                      tag: no-hwloc
        steps:
            - name: Checkout
              uses: actions/checkout@v3

            - name: Call Build Image Workflow
              uses: ./.github/workflows/build-image.yml
              with:
                  ref: ${{ github.ref }}
                  base: ${{ matrix.base }}
                  tag: ${{ matrix.tag }}
                  docker_username: ${{ secrets.DOCKER_USERNAME }}
                  docker_token: ${{ secrets.DOCKER_TOKEN }}
